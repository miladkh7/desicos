
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Virtual Material Model (VMM) &#8212; DESICOS 2.4.9 documentation</title>
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '2.4.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="References" href="../ref.html" />
    <link rel="prev" title="GUI for the Cone Ply Piece Optimization Tool" href="../gui/index.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="virtual-material-model-vmm">
<h1>Virtual Material Model (VMM)<a class="headerlink" href="#virtual-material-model-vmm" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The basic problem with laminated cones is the change of the local fiber angle
due to the plane ply parts and the curved cone surface. Because of the curved
surface the fibers are lying on the geodesic path, see Figure 1. There are two
different fiber angles <span class="math">\Theta_{s1}</span> and <span class="math">\Theta_{s2}</span> at the positions <span class="math">s_1</span>
and <span class="math">s_2</span>. The variable s is part of the conical coordinate system. Goldfeld
<a class="reference internal" href="../ref.html#goldfeld2007" id="id1">[goldfeld2007]</a> describes the local fiber angle <span class="math">\Theta</span> as a function of s:</p>
<div class="math">
<p><span class="math">\Theta(s)=arcsin \left( \frac{s_1}{s} \cdot sin(\Theta_1) \right)</span></p>
</div><p>This approach is only valid for the path of a single fiber. A new approach is
to describe the local fiber angle by the difference between the angle of the
point of interest and the angle of the starting point of the ply part:</p>
<div class="math">
<p><span class="math">\Theta(\phi)= \Theta_1-(\phi-\phi_1)</span></p>
</div><p>This approach can be used for ply parts with a finite width and is the key
formula for this program.</p>
<div class="figure align-center" id="id2">
<a class="reference internal image-reference" href="../../../_images/fig_012.png"><img alt="../../../_images/fig_012.png" src="../../../_images/fig_012.png" style="width: 700px;" /></a>
<p class="caption"><span class="caption-text">Figure 1: Path of Fiber on Cone</span></p>
</div>
<p>The objective of this tool is to calculate the local fiber angle and thickness
of any given point on a laminated cone. To do this the laminate will be
rebuilt as a virtual model. Each ply (i) consists of a finite number of pieces
(j) with a certain ply angle <span class="math">\Theta_i</span> and offset angle <span class="math">\phi_{i,j}</span>. These
are called ply pieces. After building the model, another algorithm determines
in which ply piece(s) a given point lies and calculates the local fiber angles
and thickness.</p>
<p>This manual is supposed to explain the VMM. The corresponding code is located
in <a class="reference internal" href="../../../modules/cppot/index.html#module-desicos.cppot.core" title="desicos.cppot.core"><code class="xref py py-mod docutils literal"><span class="pre">desicos.cppot.core</span></code></a>. This material model is used by both the
Abaqus-plugin (<a class="reference internal" href="../../../modules/abaqus/index.html#desicos.abaqus.imperfections.ppi.PPI" title="desicos.abaqus.imperfections.ppi.PPI"><code class="xref py py-class docutils literal"><span class="pre">desicos.abaqus.imperfections.ppi.PPI</span></code></a>)
and in the separate Cone Ply Piece Optimization Tool (CPPOT).</p>
</div>
<div class="section" id="coordinate-systems">
<h2>Coordinate systems<a class="headerlink" href="#coordinate-systems" title="Permalink to this headline">¶</a></h2>
<p>This program works with several different coordinate systems:</p>
<ul class="simple">
<li><strong>3D-Cartesian</strong>: Used for the model generation in ABAQUS</li>
</ul>
<div class="math">
<p><span class="math">x,y,z \in [-\infty, +\infty]</span></p>
</div><div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="../../../_images/fig_global_cart_csys.png"><img alt="../../../_images/fig_global_cart_csys.png" src="../../../_images/fig_global_cart_csys.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Figure 2: Global 3D-Cartesian coordinate system</span></p>
</div>
<ul class="simple">
<li><strong>3D-cylindrical</strong>: This often allows considerable simplification in
axisymmetric cases, such as cones. Note that the symbol <span class="math">\psi</span> is used here
for the circumferential coordinate instead of <span class="math">\theta</span>, because the latter
will be used for the fiber angle.</li>
</ul>
<div class="math">
<p><span class="math">r &amp;\in [0, +\infty] \\
\psi &amp;\in [0, 2\pi) \\
z &amp;\in [-\infty, +\infty]</span></p>
</div><div class="figure align-center" id="id4">
<a class="reference internal image-reference" href="../../../_images/fig_global_cyl_csys.png"><img alt="../../../_images/fig_global_cyl_csys.png" src="../../../_images/fig_global_cyl_csys.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Figure 3: Global 3D-cylindrical coordinate system</span></p>
</div>
<p>The coordinate transformation between Cartesian and cylindrical coordinates
and vice versa is done as follows:</p>
<div class="math">
<p><span class="math">(x, y, z) &amp;= (r\cos\psi, r\sin\psi, z) \\
(r, \psi, z) &amp;= (\sqrt{x^2 + y^2}, {\rm atan2}{(y, x)}, z)</span></p>
</div><p><strong>Unfolded coordinates</strong></p>
<p>The cone surface is a two-dimensional surface within the three-dimensional
space. Points on the cone have to satisfy the following equation:</p>
<div class="math">
<p><span class="math">r = r_{bot} - z \tan\alpha</span></p>
</div><p>Points that satisfy this equation can be described using a two-dimensional
coordinate system. For this purpose, an imaginary cut is made through the cone
at <span class="math">\psi = 0</span>, see the above figure. The apex of the cone is placed at the
origin of the new coordinate system. The edge in the direction <span class="math">\psi &gt; 0</span>
(right edge in the figure) is mapped to the horizontal axis. This results
in the layout shown below:</p>
<div class="figure align-center" id="id5">
<a class="reference internal image-reference" href="../../../_images/fig_unfolded_csys.png"><img alt="../../../_images/fig_unfolded_csys.png" src="../../../_images/fig_unfolded_csys.png" style="width: 700px;" /></a>
<p class="caption"><span class="caption-text">Figure 4: Unfolded coordinate systems (polar and Cartesian)</span></p>
</div>
<p>These unfolded coordinates can be described using two coordinate systems:</p>
<ul class="simple">
<li><strong>2D-polar</strong>: This is the most natural description:</li>
</ul>
<div class="math">
<p><span class="math">s &amp;\in [0, +\infty] \\
\phi &amp;\in [0, \phi_{max})</span></p>
</div><p>The relation between the 2D-polar coordinates <span class="math">(s, \phi)</span> and 3D-cylindrical
coordinates is as follows, valid only for points on the cone surface:</p>
<div class="math">
<p><span class="math">(s, \phi) &amp;= \left(\frac{r}{\sin\alpha}, \psi\sin\alpha\right) \\
(r, \psi, z) &amp;= \left(s\sin\alpha, \frac{\phi}{\sin\alpha},
\frac{r_{bot}}{\tan\alpha} - s\cos\alpha\right)</span></p>
</div><p>Using the above coordinate transformation, the maximum value for the
<span class="math">\phi</span>-coordinate (labeled <span class="math">phi_{max}</span>) can be calculated, as well as the
radial limits <span class="math">s_{bot}</span> and <span class="math">s_{top}</span>:</p>
<div class="math">
<p><span class="math">\phi_{max} &amp;= 2\pi\sin\alpha \\
s_{bot} &amp;= \frac{r_{bot}}{\sin\alpha} \\
s_{top} &amp;= \frac{s_{top}}{\sin\alpha} =
\frac{r_{bot} - H\tan\alpha}{\sin\alpha} =
\frac{r_{bot}}{\sin\alpha} - \frac{H}{\cos\alpha}</span></p>
</div><ul class="simple">
<li><strong>2D-Cartesian</strong>: Used for geometrical operations on the unfolded cone
(defining lines, calculating intersection points, …):</li>
</ul>
<div class="math">
<p><span class="math">\eta, \zeta \in [-\infty,+\infty]</span></p>
</div><p>The transformation rules are fairly straightforward:</p>
<div class="math">
<p><span class="math">(\eta, \zeta) &amp;= (s\cos\phi, s\sin\phi) \\
(s, \phi) &amp;= \left(\sqrt{\eta^2 + \zeta^2},
{\rm atan2}{(\zeta, \eta)}\right)</span></p>
</div><ul class="simple">
<li><strong>Laminate coordinates</strong> To describe the orientation of fibers and plies,
a laminate coordinate system is used in Abaqus, as is shown in the figure
below. This is a local coordinate system that defines three directions at
each point on the cone. The 1-direction is obtained by projecting the
z-axis onto the cone surface, i.e. it is always pointing towards the
apex of the cone. The n-direction is normal to the surface and always
pointing outward. The 2-direction is obtained by rotating the 1-direction
<span class="math">90^\circ</span> around the normal vector, using the right-hand rule. The angle
<span class="math">\theta</span> is used to define the orientation of a fiber or ply. It is defined
as being 0 for fibers parallel to the 1-direction and increases when
rotating from the 1- to 2-direction, as shown in the figure.</li>
</ul>
<div class="figure align-center" id="id6">
<a class="reference internal image-reference" href="../../../_images/fig_laminate_csys.png"><img alt="../../../_images/fig_laminate_csys.png" src="../../../_images/fig_laminate_csys.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Figure 5: Laminate coordinate system, shown relative to both global (top)
and unfolded (bottom) coordinates.</span></p>
</div>
</div>
<div class="section" id="detailed-cone-geometry">
<h2>Detailed cone geometry<a class="headerlink" href="#detailed-cone-geometry" title="Permalink to this headline">¶</a></h2>
<p>The cone geometry used in the DESICOS project is slightly more complex than the
elementary truncated cone discussed in the previous chapter. Apart from the
free cone area, additional support parts are present along both edges, as shown
in the figure below. The support areas will be partially cut away (to obtain
straight, clean edges) after laminating and the rest will be molded in resin.
These areas do need to be considered when discussing the ply placement process,
however.</p>
<div class="figure align-center" id="id7">
<a class="reference internal image-reference" href="../../../_images/fig_cone_geom.png"><img alt="../../../_images/fig_cone_geom.png" src="../../../_images/fig_cone_geom.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Figure 6: Example of cone geometry.</span></p>
</div>
<p>Translating this geometry to the unfolded cone results in the figure below.
There are four relevant radii, labelled s1 to s4. These correspond to the edges
numbered 1 to 4 in figure 6. The total area between the dotted arcs (s1 and s4)
will need to be covered with ply pieces. However, only the area between the
solid arcs (s2 and s3) will be relevant when determining the local fiber
orientation at a later stage.</p>
<div class="figure align-center" id="id8">
<a class="reference internal image-reference" href="../../../_images/fig_s_radii.png"><img alt="../../../_images/fig_s_radii.png" src="../../../_images/fig_s_radii.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Figure 7: Radii used in unfolded cone.</span></p>
</div>
<p>In the code, the geometry of the cone is encapsulated in the
<a class="reference internal" href="../../../modules/cppot/index.html#desicos.cppot.core.geom.ConeGeometry" title="desicos.cppot.core.geom.ConeGeometry"><code class="xref py py-class docutils literal"><span class="pre">desicos.cppot.core.geom.ConeGeometry</span></code></a> class. This class is constructed
based on a few input parameters, listed below. All other parameters
(<code class="docutils literal"><span class="pre">s1</span></code> .. <code class="docutils literal"><span class="pre">s4</span></code>, <code class="docutils literal"><span class="pre">rtop</span></code>, …) are then easily retrieved upon request.</p>
<blockquote>
<div><ul class="simple">
<li>The bottom radius of the free cone <span class="math">r_{bot}</span> (400 mm in figure 6)</li>
<li>The semi-vertex angle <span class="math">\alpha</span> (<span class="math">35^\circ</span> in figure 6)</li>
<li>The free cone height <span class="math">H</span> (300 mm in figure 6)</li>
<li>The support height <code class="docutils literal"><span class="pre">extra_height</span></code> (70 mm in figure 6)</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="building-the-ply-model">
<h2>Building the Ply model<a class="headerlink" href="#building-the-ply-model" title="Permalink to this headline">¶</a></h2>
<p>The VMM is the virtual model of the lay-up of the laminated cone. Every ply
consists of a finite number of pieces. Between the parts are no gaps, depending
on the ply piece geometry there may be overlaps. In the Abaqus-plugin only one
type of ply piece is available:</p>
<ul class="simple">
<li>Type A: Trapezoidal ply pieces without overlaps</li>
</ul>
<p>Two additional shapes are accessible through the CPPOT-program:</p>
<ul class="simple">
<li>Type B: Trapezoidal ply pieces with one overlap</li>
<li>Type C: Rectangular ply pieces with many overlaps.</li>
</ul>
<p>In this document, only shape A will be discussed, because it is the only one
that has actually been used in the manufacturing of cones.</p>
<p>The basic process flow for building the model for a single ply is:</p>
<ul class="simple">
<li><ol class="first arabic">
<li>Construct a prototype piece</li>
</ol>
</li>
<li><ol class="first arabic" start="2">
<li>Copy and rotate the prototype piece to fill the entire cone</li>
</ol>
</li>
<li><ol class="first arabic" start="3">
<li>Calculate the local fiber orientation at the desired points</li>
</ol>
</li>
</ul>
<p>The three numbered steps will now be discussed sequentially:</p>
</div>
<div class="section" id="constructing-the-prototype-piece">
<h2>1. Constructing the prototype piece<a class="headerlink" href="#constructing-the-prototype-piece" title="Permalink to this headline">¶</a></h2>
<p>The construction of a single ply piece will now be described step-by-step.
Objective is mainly to describe the procedure, not to bother the reader with
implementation details (e.g. “How to find the intersection of two lines?”). For
the latter, consult the relevant pieces of code. The implementation of the
procedure described here is contained in the method
<a class="reference internal" href="../../../modules/cppot/index.html#desicos.cppot.core.ply_model.TrapezPlyPieceModel.construct_single_ply_piece" title="desicos.cppot.core.ply_model.TrapezPlyPieceModel.construct_single_ply_piece"><code class="xref py py-func docutils literal"><span class="pre">desicos.cppot.core.ply_model.TrapezPlyPieceModel.construct_single_ply_piece()</span></code></a>.</p>
<p>The constructed ply pieces will be trapezoidal in shape, as shown in the
figure below. These trapezoidal pieces will be constructed such the angle that
is spanned or “covered” by each ply piece is a constant <span class="math">\Delta\phi</span>,
independent of <span class="math">s</span>. This property is important to allow covering the entire
cone with similarly-shaped pieces, without having gaps or overlaps.</p>
<div class="figure align-center" id="id9">
<a class="reference internal image-reference" href="../../../_images/fig_single_ply_piece.png"><img alt="../../../_images/fig_single_ply_piece.png" src="../../../_images/fig_single_ply_piece.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text">Figure 8: View of single ply piece</span></p>
</div>
<p><strong>Step 1: Origin line `L_0`</strong></p>
<p>The first step is to construct the <em>origin line</em> <span class="math">L_0</span>. All fibers in the ply
piece will be parallel to this line. It is defined based on three parameters:</p>
<ul class="simple">
<li>The nominal fiber angle <span class="math">\theta_{nom}</span>, which is the same for all ply pieces
in a ply.</li>
<li>The nominal ply piece angle <span class="math">\phi_{nom}</span>. Note that this is a property of the
individual ply piece, not a property of the ply.</li>
<li>The starting position <span class="math">s_{\theta nom}</span>, which is the radius at which
(at the nominal ply piece angle <span class="math">\phi_{nom}</span>) the actual fiber angle equals
the nominal fiber angle.</li>
</ul>
<p>The line <span class="math">L_0</span> is then defined as the line going through the point
<span class="math">(s, \phi) = (s_{\theta nom}, \phi_{nom})</span> at an angle
(<span class="math">\theta_{nom} + \phi_{nom}</span>) with respect to the <span class="math">\eta</span>-axis. See figure 9:</p>
<div class="figure align-center" id="id10">
<a class="reference internal image-reference" href="../../../_images/fig_origin_line.png"><img alt="../../../_images/fig_origin_line.png" src="../../../_images/fig_origin_line.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text">Figure 9: Construction of origin line <span class="math">L_0</span></span></p>
</div>
<p><strong>Step 2: Base line `L_2`</strong></p>
<p>The <em>base line</em> <span class="math">L_2</span> is the line along which the width of the ply piece will
be measured. <span class="math">L_2</span> is defined as the line perpendicular to <span class="math">L_0</span> and tangent to
the circle with radius <span class="math">s_4</span>. Point <span class="math">P_0</span> is then defined as the intersection
point of <span class="math">L_0</span> and <span class="math">L_2</span>. See Figure 10:</p>
<div class="figure align-center" id="id11">
<a class="reference internal image-reference" href="../../../_images/fig_base_line.png"><img alt="../../../_images/fig_base_line.png" src="../../../_images/fig_base_line.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text">Figure 10: Construction of base line <span class="math">L_2</span></span></p>
</div>
<p><strong>Step 3:  Corners at outer edge</strong></p>
<p>The outer edge of the polygon is formed by the line <span class="math">L_2</span>. The position of the
corner points <span class="math">P_2</span> and <span class="math">P_3</span> along this line is determined by two parameters:</p>
<ul class="simple">
<li>The maximum ply piece width <span class="math">w_{max}</span> is equal to the distance between the
two points <span class="math">P_2</span> and <span class="math">P_3</span>.</li>
<li>The <em>eccentricity parameter</em> <span class="math">a_{ecc}</span> (also known as <em>width variation</em>)
determines the placement of the two points relative to <span class="math">P_0</span>. <span class="math">a_{ecc}</span> is
defined as the distance from <span class="math">P_0</span> to <span class="math">P_2</span>, divided by <span class="math">w_{max}</span>. So for
<span class="math">a_{ecc} = 0</span>, <span class="math">P_2</span> and <span class="math">P_0</span> coincide and for <span class="math">a_{ecc} = 1</span>, <span class="math">P_3</span> and
<span class="math">P_0</span> coincide.</li>
</ul>
<p>This is also shown in figure 11. So <span class="math">P_2</span> is defined as the point on <span class="math">L_2</span> at a
distance (<span class="math">a_{ecc}\cdot w_{max}</span>) from <span class="math">L_0</span>, while <span class="math">P_3</span> is defined as the
point on <span class="math">L_2</span> at a distance (<span class="math">(1 - a_{ecc})\cdot w_{max}</span>) from <span class="math">L_0</span>.
For completeness, it should be mentioned that <span class="math">P_2</span> is to be placed in the
counter-clockwise direction relative to <span class="math">P_0</span> and <span class="math">P_3</span> in the clockwise
direction relative to <span class="math">L_0</span>, as is evident in the figure below.</p>
<div class="figure align-center" id="id12">
<a class="reference internal image-reference" href="../../../_images/fig_P2_P3.png"><img alt="../../../_images/fig_P2_P3.png" src="../../../_images/fig_P2_P3.png" style="width: 300px;" /></a>
<p class="caption"><span class="caption-text">Figure 11: Construction of <span class="math">P_2</span> and <span class="math">P_3</span></span></p>
</div>
<p><strong>Step 4:  Calculating the spanned angle</strong></p>
<p>Now it is necessary to calculate the angle <span class="math">\Delta\phi</span> that is spanned by the
ply piece. This angle is determined by the position of points <span class="math">P_2</span> and <span class="math">P_3</span>.
However, it would be wrong to take the angular coordinates of <span class="math">P_2</span> and <span class="math">P_3</span>
and subtract them (<span class="math">\Delta\phi \neq \phi_{P2} - \phi_{P3}</span>), because the radii
<span class="math">s_{P2}</span> and <span class="math">s_{P3}</span> of these points are not the same.</p>
<p>Therefore, the points <span class="math">T_2</span> and <span class="math">T_3</span> are constructed first. Point <span class="math">T_i</span> is
defined as the point lying on <span class="math">L_0</span> at a distance <span class="math">s_{Pi}</span> from the origin.
Now the two constituent parts of <span class="math">\Delta\phi</span> can be calculated. One part is
the difference in angular coordinate between <span class="math">P_2</span> and <span class="math">T_2</span>, the other between
<span class="math">T_3</span> and <span class="math">P_3</span>. This is shown more clearly in figure 12 below.</p>
<div class="math">
<p><span class="math">\Delta\phi_1 &amp;= \phi_{P2} - \phi_{T2} \\
\Delta\phi_2 &amp;= \phi_{T3} - \phi_{P3} \\
\Delta\phi &amp;= \Delta\phi_1 + \Delta\phi_2</span></p>
</div><div class="figure align-center" id="id13">
<a class="reference internal image-reference" href="../../../_images/fig_spanned_angle.png"><img alt="../../../_images/fig_spanned_angle.png" src="../../../_images/fig_spanned_angle.png" style="width: 300px;" /></a>
<p class="caption"><span class="caption-text">Figure 12: Angle <span class="math">\Delta\phi</span> spanned by ply piece</span></p>
</div>
<p><strong>Step 5:  Constructing the side lines</strong></p>
<p>Now the side lines <span class="math">L_1</span> and <span class="math">L_3</span> can be constructed by rotating <span class="math">L_0</span> around
the origin. <span class="math">L_1</span> is constructed by rotating <span class="math">L_0</span> counter-clockwise with angle
<span class="math">\Delta\phi_1</span>, <span class="math">L_3</span> is constructed by rotating <span class="math">L_0</span> clockwise around angle
<span class="math">\Delta\phi_2</span> .The intersection point between <span class="math">L_1</span> and circle <span class="math">s_1</span> is
denoted as <span class="math">P_{1a}</span>, the intersection point between <span class="math">L_3</span> and circle <span class="math">s_1</span> is
denoted as <span class="math">P_{4a}</span>. All of this is shown in figure 13:</p>
<div class="figure align-center" id="id14">
<a class="reference internal image-reference" href="../../../_images/fig_side_lines.png"><img alt="../../../_images/fig_side_lines.png" src="../../../_images/fig_side_lines.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text">Figure 13: Constructing the side lines <span class="math">L_1</span> and <span class="math">L_3</span></span></p>
</div>
<p><strong>Step 6:  Corners at the inner edge</strong></p>
<p>Now the inner edge of the polygon is to be defined. First, it is examined which
point is further from <span class="math">L_2</span>, either <span class="math">P_{1a}</span> or <span class="math">P_{4a}</span>. See figure 14, in
the shown example case the point <span class="math">P_{4a}</span> is the furthest from <span class="math">L_2</span>. The line
<span class="math">L_4</span> is then defined to be parallel to <span class="math">L_2</span> and through this furthest point.
Then points <span class="math">P_{1b}</span> and <span class="math">P_{4b}</span> are defined as the intersection points of <span class="math">L_4</span> with,
respectively, <span class="math">L_1</span> and <span class="math">L_3</span>.</p>
<div class="figure align-center" id="id15">
<a class="reference internal image-reference" href="../../../_images/fig_constr_L4.png"><img alt="../../../_images/fig_constr_L4.png" src="../../../_images/fig_constr_L4.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text">Figure 14: Constructing <span class="math">L_4</span></span></p>
</div>
<p>There is a special case, which is shown in figure 15. Namely, for some
combinations of parameters, the previous procedure may lead to polygons
(<span class="math">P_{1b}</span>, <span class="math">P_{2}</span>, <span class="math">P_{3}</span>, <span class="math">P_{4b}</span>) that are self-intersecting. In this
case, both <span class="math">P_1</span> and <span class="math">P_4</span> are defined to be equal to the intersection point of
<span class="math">L_1</span> and <span class="math">L_3</span> and the ply piece becomes a triangle. This results in some very
small areas along circle <span class="math">s_1</span> being not covered with any ply piece. This is
deemed acceptable, because the area between <span class="math">s_1</span> and <span class="math">s_2</span> is not relevant for
the finite element model.</p>
<p>In the normal case of figure 14, where the polygon is not self-intersecting,
the final locations of <span class="math">P_1</span> and <span class="math">P_4</span> are equal to <span class="math">P_{1b}</span> and <span class="math">P_{4b}</span>,
respectively.</p>
<div class="figure align-center" id="id16">
<a class="reference internal image-reference" href="../../../_images/fig_triangular_piece.png"><img alt="../../../_images/fig_triangular_piece.png" src="../../../_images/fig_triangular_piece.png" style="width: 250px;" /></a>
<p class="caption"><span class="caption-text">Figure 15: Special case for triangular ply piece</span></p>
</div>
<p><strong>Step 7: Final ply piece</strong></p>
<p>The final shape of the ply piece is shown in figure 16 below. Its shape is
defined by the four corner points <span class="math">P_i (i = 1...4)</span>. On the circle with radius
<span class="math">s_{\theta nom}</span> (the starting position), the ply piece spans an angle from
<span class="math">\phi_{nom, min}</span> to <span class="math">\phi_{nom, max}</span>. These angles can be calculated by:</p>
<div class="math">
<p><span class="math">\phi_{nom, min} &amp;= \phi_{nom} - \Delta\phi_2 \\
\phi_{nom, max} &amp;= \phi_{nom} + \Delta\phi_1</span></p>
</div><p>Additionally, the <em>limit angles</em> of the ply piece are defined as the minimal
and maximum value of the angular coordinate. Since the extreme values are
always located at the corner points, these can be calculated by:</p>
<div class="math">
<p><span class="math">\phi_{limit, min} &amp;= \min_i(\phi_{Pi}) \\
\phi_{limit, max} &amp;= \max_i(\phi_{Pi})</span></p>
</div><div class="figure align-center" id="id17">
<a class="reference internal image-reference" href="../../../_images/fig_final_piece.png"><img alt="../../../_images/fig_final_piece.png" src="../../../_images/fig_final_piece.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Figure 16: Final ply piece</span></p>
</div>
</div>
<div class="section" id="constructing-all-ply-pieces">
<h2>2. Constructing all ply pieces<a class="headerlink" href="#constructing-all-ply-pieces" title="Permalink to this headline">¶</a></h2>
<p>Based on the prototype ply piece discussed in the previous section, the
complete set of ply pieces can be constructed. In the code, this is implemented
mainly in the method
<a class="reference internal" href="../../../modules/cppot/index.html#desicos.cppot.core.ply_model.PlyPieceModel.rebuild" title="desicos.cppot.core.ply_model.PlyPieceModel.rebuild"><code class="xref py py-func docutils literal"><span class="pre">desicos.cppot.core.ply_model.PlyPieceModel.rebuild()</span></code></a>.</p>
<p>First the required number of ply pieces is determined:</p>
<div class="math">
<p><span class="math">n_{pieces} = \frac{\phi_{max}}{\Delta\phi}</span></p>
</div><div class="figure align-center" id="id18">
<a class="reference internal image-reference" href="../../../_images/fig_continuity.png"><img alt="../../../_images/fig_continuity.png" src="../../../_images/fig_continuity.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text">Figure 17: Continuity problem</span></p>
</div>
<p>Generally, <span class="math">n_{pieces}</span> is not an integer, so covering the entire cone with
similar pieces would result in a discontinuous model, as shown in figure 17.
To remedy this problem, a smaller <em>rest</em> piece is added. This rest piece should
span an angle: (with <span class="math">\lfloor x\rfloor</span> denoting the floor function)</p>
<div class="math">
<p><span class="math">\Delta\phi_{rest} &amp;= \phi_{max} - \lfloor n_{pieces}\rfloor\Delta\phi \\
&amp;= n_{pieces}\Delta\phi - \lfloor n_{pieces}\rfloor\Delta\phi \\
&amp;= \left(n_{pieces} - \lfloor n_{pieces}\rfloor\right)\Delta\phi \\
&amp;= f_{rest}\Delta\phi</span></p>
</div><p>with</p>
<div class="math">
<p><span class="math">f_{rest} = \frac{\Delta\phi_{rest}}{\Delta\phi}
= n_{pieces} - \lfloor n_{pieces} \rfloor</span></p>
</div><p>So in words, <span class="math">f_{rest}</span> is the fractional part of <span class="math">n_{pieces}</span>. To construct
the rest piece, the same procedure is followed as for a normal ply piece.
However, during step 4, the calculated values of <span class="math">\Delta\phi_1</span> and
<span class="math">\Delta\phi_2</span> are multiplied by <span class="math">f_{rest}</span> as stated below. This results in
a ply piece whose angular span <span class="math">\Delta\phi_{rest}</span> satisfies the above
equations. The positions of points <span class="math">P_2</span> and <span class="math">P_3</span> (and, of course, the
calculations in subsequent steps) are adjusted accordingly.</p>
<div class="math">
<p><span class="math">\Delta\phi_{rest,1} &amp;= f_{rest}\Delta\phi_1 \\
\Delta\phi_{rest,2} &amp;= f_{rest}\Delta\phi_2 \\
\Delta\phi_{rest} &amp;= \Delta\phi_{rest,1} + \Delta\phi_{rest,2}
= f_{rest}\Delta\phi</span></p>
</div><p>Now the procedure to cover the entire cone with ply pieces is as follows. The
first piece is placed at a nominal angle <span class="math">\phi_{nom}</span> equal to <span class="math">\phi_{offset}</span>.
This is done to allow offsettnig multiple plies with the same nominal fiber
orientation with respect to each other. This avoids that the ply piece
edges in multiple plies coincide, which would (unnecessarily) cause weak spots
in the actual cone. The offset parameter is specified in relative terms
(0…1), based on this value <span class="math">\phi_{offset}</span> is calculated as follows:</p>
<div class="math">
<p><span class="math">\phi_{offset} = f_{rel,offset}\Delta\phi \\
{\rm with}\qquad f_{rel,offset} \in [0, 1)</span></p>
</div><p>Ply pieces are then placed in both directions at angular increments of
<span class="math">\pm\Delta\phi</span>. Pieces are added as long as they cover some area in the
angular range <span class="math">[0, \phi_{max}]</span>, which is the case if both below-stated
inequalities are satisfied.</p>
<div class="math">
<p><span class="math">\phi_{limit,min} &amp;\leq \phi_{max} \\
\phi_{limit,max} &amp;\geq 0</span></p>
</div><p>The possible result of this operation is shown in figure 18. Here the unfolded
cone is drawn in red, the first ply piece in blue, the other ply pieces in
green and the nominal angle of each ply piece as a dashed black line. The rest
piece is inserted right after (in counter-clockwise direction) the first piece
for which <span class="math">\phi_{limit,min} &gt; 0</span>. This prevents the rest piece from overlapping
the “cut” in the model, which would add additional complexity to the model.
Some special handling is needed to set the angular offsets between the rest
piece and its neighboring pieces. If the nominal angles of the rest piece,
the previous piece and the next piece are named <span class="math">\phi_{nom,rest}</span>,
<span class="math">\phi_{nom,prev}</span> and <span class="math">\phi_{nom,next}</span>, respectively, their mutual relations
are as stated below. Refer also to the figure.</p>
<div class="math">
<p><span class="math">\phi_{nom,rest} - \phi_{nom,prev} &amp;= \Delta\phi_1 + \Delta\phi_{rest,2} \\
\phi_{nom,next} - \phi_{nom,rest} &amp;= \Delta\phi_{1,rest} + \Delta\phi_2</span></p>
</div><div class="figure align-center" id="id19">
<a class="reference internal image-reference" href="../../../_images/fig_all_pieces.png"><img alt="../../../_images/fig_all_pieces.png" src="../../../_images/fig_all_pieces.png" style="width: 700px;" /></a>
<p class="caption"><span class="caption-text">Figure 18: Covering the cone</span></p>
</div>
<p>Note that the model contains a few more ply pieces than the actual cone,
because the pieces that intersect the cut (<span class="math">\phi = 0</span> and <span class="math">\phi = \phi_{max}</span>)
are represented twice. This is done because it simplifies the implementation,
while not affecting the results in any way.</p>
</div>
<div class="section" id="calculating-the-local-orientation">
<h2>3. Calculating the local orientation<a class="headerlink" href="#calculating-the-local-orientation" title="Permalink to this headline">¶</a></h2>
<p>To calculate what the local fiber angle is at any point on the cone, several
steps are needed.</p>
<p><strong>Step 1:  Change coordinate system</strong></p>
<p>First, the coordinates in the global coordinate system have to be transformed
to the coordinates of the unfolded cone, i.e. <span class="math">(\eta, \zeta)</span> and/or
<span class="math">(s, \phi)</span>. These coordinate transformations have been discussed in a
previous chapter on this page and will not be repeated.</p>
<p><strong>Step 2:  Find the correct ply piece</strong></p>
<p>Next, it is necessary to find the ply piece(s) located at the given
coordinates. This is done by iterating over all ply pieces and then,for each
ply piece:</p>
<ul class="simple">
<li>Quickly check whether <span class="math">\phi_{limit,min} \leq \phi \leq \phi_{limit,max}</span>.
If not, continue.</li>
<li>Perform the (computationally more expensive) test whether the point is inside
the polygon that defines this ply piece. In earlier versions the
“interior angle”-algorithm was used, but for performance reasons this was
changed to the “ray casting”-algorithm. Both algorithms are widely used and
extensively documented in other sources. If this check returns a positive
result, stop iteration and return this ply piece. If not, continue.</li>
<li>If iteration completes without having found a ply piece, the point is not on
the cone at all and <code class="docutils literal"><span class="pre">NaN</span></code> is returned.</li>
</ul>
<p><strong>Step 3:  Find the local angle</strong>
A relation for the local fiber angle can be found, based on the principle that
the sum of all angles inside a triangle is always equal to <span class="math">180^\circ</span>. This
results in the following equation:</p>
<div class="math">
<p><span class="math">\theta_{local} = \theta_{nom} - (\phi - \phi_{nom})</span></p>
</div><p>An example plot of the local fiber angle is shown in the figure below. Note
that all points within the same ply piece have a constant fiber angle along
radial lines (<span class="math">\phi = {\rm const}</span>) and that there are significant
discontinuities between adjacent plies.</p>
<div class="figure align-center" id="id20">
<a class="reference internal image-reference" href="../../../_images/fig_orientation.png"><img alt="../../../_images/fig_orientation.png" src="../../../_images/fig_orientation.png" style="width: 750px;" /></a>
<p class="caption"><span class="caption-text">Figure 18: Example of local fiber orientation throughout the cone</span></p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../../index.html">
    <img class="logo" src="../../../_static/../../../logo/desicos.png" alt="Logo"/>
    
  </a>
</p>










<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/index.html">Modules</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Tutorials</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2012-2015 Desicos Improved Software Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>